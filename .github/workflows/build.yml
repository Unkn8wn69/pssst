name: Build Binary

on:
  push:
    branches:
      - gui # Set this to the branch you use
  pull_request:
    branches:
      - gui  # Set this to the branch you use

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Check out repository
      uses: actions/checkout@v3

    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'  # Set this to your Python version

    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install click customtkinter tkinter Pillow pyinstaller

    - name: Clone additional repository
      run: git clone https://github.com/trezor/python-shamir-mnemonic python-shamir-mnemonic

    - name: Build binary with PyInstaller
      run: |
        pyinstaller --onefile --add-data "assets:assets" --add-data "wordlist.json:." --add-data "python-shamir-mnemonic/shamir_mnemonic:shamir_mnemonic" --paths=$(python -c "import customtkinter; print(customtkinter.__path__[0])") --hidden-import PIL._tkinter_finder gui.py

    - name: Upload Artifacts
      uses: actions/upload-artifact@v3
      with:
        name: binary
        path: dist/gui
